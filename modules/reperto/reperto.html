
<style>

    #repertomap {
        width: 100%;
        height: 100%;
    }

	.send-mail
	{
		font-size: 20px !important;
		margin-top: -34px;
		margin-left: -5px;
		margin-right: 7px;
		color: rgba(0,0,0,0.6);
	}
	
	.send-mail:hover
	{
		color: rgba(0,0,0,0.8);
	}
	#partenaire
	{
		background: url('images/logo-CAC.jpg') no-repeat;
		-webkit-background-size: cover; /* pour anciens Chrome et Safari */
		background-size: auto; 
		margin: 5px;
	}
	
	.animate-disappear
	{
     /*   animation: fade 5s;*/
        display:none;
	}
	
	.animate-appear
	{
     /*  animation: fade 5s;*/
        display:block;
        position:static;
	}
	
	.open
	{
        position: relative;
        top: -2px;
        right: -21px;
        color: inherit;
	}
	
	@keyframes fade {
        0% {
            opacity: 1;
        }
        100% {
            opacity: 0;
        }
    }

</style>

<div ng-show="odass.isModule('annuaire')">

	<div ng-controller="RepertoController as reperto" id="repertoControllerWrapper">


		<section id="annuaire-header" class="row">
			<div class="col-md-4">
				<p ng-show="reperto.activeFilters.keywords.length > 0">
					Filtres actifs :
					<span ng-show="reperto.activeFilters.keywords.length > 0">
						<span ng-repeat="filter in reperto.activeFilters.keywords"> 
							<span class="label label-info"> {{filter}} 
								<span style="cursor: pointer" class="glyphicon glyphicon-remove" ng-click="reperto.removeFilter('keywords', filter)"> </span>
							</span> &nbsp;
						</span>
					</span>
				</p>
			</div>
			
			<div class="col-md-3">
				
<!-- 				<filters-box></filters-box> -->
			</div>
			
<!-- 			<div class="col-md-1"> -->
<!-- 				<a class="btn btn-info icon-action" ng-click="reperto.init()"> -->
<!-- 					<span class="glyphicon glyphicon-refresh"></span> -->
<!-- 				</a> -->
<!-- 				<a class="btn btn-info icon-action" ng-click="reperto.displaySavedInitiatives()"> -->
<!-- 					<span class="glyphicon glyphicon-star"></span> -->
<!-- 				</a> -->
<!-- 			</div> -->
			
		</section>
		
		<section id="guide-intro">
			<div class="panel panel-default">
				<div class="panel-heading">
						<button type="button" class="close" aria-label="Close" ng-hide="reperto.intro_reduced" ng-click="reduce.reduceIntro()">
							<span aria-hidden="true">&times;</span>
						</button>
						<button type="button" class="close" aria-label="Open" ng-show="reperto.intro_reduced" ng-click="reperto.expandIntro()">
							<span aria-hidden="true">&loz;</span>
						</button>
						<h4 id="introduction-titre"></h4>
					</div>
				
		      		<div class="panel-body">
		       			<div id="introduction-contenu"></div>
		    		</div>
		  		</div>
		</section>
		
		<section id="catalogue" class="prettyprint" ng-show="reperto.navigationmode == 'print'">
		
			<div class="toolbox">
				<span class="btn btn-primary" ng-click="reperto.exportToPdf()"><span class="glyphicon glyphicon-print"></span> IMPRIMER</span> &nbsp;
				<span class="btn btn-default" ng-click="reperto.navigationmode='tree'"><span class="glyphicon glyphicon-arrow-left"></span> RETOUR</span>
			</div>
			
			<div id="printzone" class="sheet A4 portrait">
				<h1 ng-bind-html="reperto.printableGuide.titre"></h1>
				<p class="guide description" ng-bind-html="reperto.printableGuide.description"></p>
				<section class="partie" ng-repeat="partie in reperto.printableGuide.parties">
					<h2 ng-bind-html="partie.titre"></h2>
					<p class="partie description" ng-bind-html="partie.description"></p>
					<article ng-repeat="chapitre in partie.chapitres">
						<h3 ng-bind-html="chapitre.titre"></h3>
						<p class="chapitre description" ng-bind-html="chapitre.description"></p>
						<div class="idee" ng-repeat="idee in chapitre.idees">
							<h4 ng-bind-html="idee.titre"></h4>
							<p class="idee description" ng-bind-html="idee.description"></p>
							<ul class="experiences">
								<li class="experience" ng-repeat="experience in idee.experiences">
									<h5 ng-bind-html="experience.label"></h5>
									<div class="experience description" ng-bind-html="experience.descriptionlongue"></div>
									<div class="contact"><a ng-repeat="contact in experience.references" href="{{contact.lien}}">{{contact.label}}</a></div>
									<div class="localisation"></div>
								</li>
							</ul>
						</div>
					</article>
				</section>
			</div>
		</section>
		
		<section id="annuaire-body" class="row">
				
			
			<div class="well" style="width: 200px; height:200px; position: absolute; top:50%; left: 50%; margin-top: -100px; margin-left: -100px;padding: 25px;" ng-hide="reperto.guide_is_loaded">
				guide en cours de chargement...<br/><br/>
				<img style="margin: auto; display: block;" src="images/chargement.gif" width=75 height=75></img>
			</div>
			
			
			
				<!-- THESAURUS NAVIGATION ARBORESCENTE   -->
				
				
				
				
			<div class="col-md-3" ng-show="reperto.navigationmode == 'tree'">
				<section>
				
					<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
					  	<div class="panel panel-default">
					  		<div id="partenaire" class="panel-body">
							  	<a href="http://www.associations-citoyennes.net/" target="_blank" style="display: block; width: 100%; height: 100%">&nbsp;</a>
								<a title="Envoyez vos commentaires sur le guide" href="mailto:cac_repertoire@odass.org?subject=Guide%20National%20Ecologie" class="glyphicon glyphicon-envelope pull-right send-mail"></a>
							</div>
						</div>
					  	
					  	<div ng-repeat="item in reperto.thesaurus.nodes" class="panel panel-default {{item.id}}">
							<div class="panel-heading" role="tab" id="headingOne">
						      	
					        	<a class="pull-right" role="button" ng-hide="reperto.isExpanded('h4-' + item.id)" ng-click="reperto.toggleExpandedZone('h4-' + item.id)">replier</a>
					        	<a class="pull-right" role="button" ng-show="reperto.isExpanded('h4-' + item.id)" ng-click="reperto.toggleExpandedZone('h4-' + item.id)">déplier</a>
						      	<h4 class="panel-title" href="#{{item.id}}" id="h4-{{item.id}}">
						      		<a ng-click="reperto.selectSection(item)">{{item.titre}}</a>
						      	</h4>
						      	
						    </div>
						    
						    <div id="{{item.id}}" class="panel-collapse" role="tabpanel" aria-labelledby="headingOne" ng-class="{ 'collapse': ! $first}">
						      	<div class="panel-body">
						        	<ol>
							        	<li ng-repeat="subItem in item.nodes">
							          		<div>
							            		<a href="" ng-click="reperto.selectChapter(item, subItem)">{{subItem.titre}}</a>
							          		</div>
							        	</li>
							      	</ol>
						      	</div>
							</div>
						</div>
					</div>
				</section>
				<div class="clearfix"></div>
			</div>



			<!--  COLONNE PRINCIPALE  -->
			 <div class="col-md-9" style="width: 150vh; height: 75vh;" ng-show="reperto.navigationmode == 'map'">
				
				
				<div id="repertomap"></div>
				
				
				<div class="row" ng-show="reperto.guide_is_loaded" style="margin-left: 0px;">
					<div class="col-md-1 filter" ng-repeat="categorie in reperto.availableFilters.keywords" 
						style="background-color:#{{categorie.color}}; padding:5px 2px 5px 2px; color: white; font-size: 0.9em"
						ng-click="reperto.toggleCategory(categorie)" 
						ng-class="{ 'active': reperto.isCategorieActive(categorie)}">
						<span class="glyphicon" ng-class="{ 'glyphicon-eye-open': reperto.isCategorieActive(categorie), 'glyphicon-eye-close': ! reperto.isCategorieActive(categorie)}"></span>
						&nbsp;{{categorie.label}}
					</div>
				
				</div>
			 </div>
			 
			 
			 
			 
			
			<div class="col-md-6" id="initiatives-area" ng-show="reperto.navigationmode == 'tree'">
				<p class="">
					<ol class="breadcrumb well" style="display: inline-block;margin-left: 15px; padding: 15px; font-weight: bold;">
					  <li ng-click="reperto.selectThesaurus()">
					  	
						<span class="glyphicon glyphicon-book"></span>
						<a href="#" style="font-size: 16px !important">{{reperto.display.guide.titre}}</a>
					  </li>
					  <li ng-click="reperto.selectSection(reperto.display.section)" ng-show="reperto.display.breadcrumb.section">
					  	<a href="#">{{reperto.display.breadcrumb.section}}</a>
					  </li>
					  <li ng-click="reperto.selectChapter(reperto.display.section, reperto.display.chapitre)" ng-show="reperto.display.breadcrumb.chapitre">
					  	<span>{{reperto.display.breadcrumb.chapitre}}</span>
					  </li>
					</ol>
					<!-- a class="btn btn-primary"><span class="glyphicon glyphicon-open"></span> ouvrir un autre repertoire</a-->
				</p>
				
				<h3 class="well" style="padding-left: 15px; margin-top: 22px; padding:15px; font-size:14px; color: rgba(0,0,0,0.8)">
					<span ng-show="reperto.activeFilters.keywords.length == 0" style="">{{reperto.display.idees.length}}</span>
					<span ng-show="reperto.activeFilters.keywords.length != 0" style="">{{reperto.ideaDisplayed}}</span>
					actions possibles&nbsp;&nbsp;
				</h3>
	
				<div style="" ng-show="reperto.navigationmode == 'tree'">
					 <idees></idees>
				 </div>
	
				<div class="clearfix"></div>
				
				<div ng-show="reperto.navigationmode == 'tree'" class="row">
					<nav aria-label="Page navigation">
					  <ul class="pagination pagination-sm">
					    <li><a href="#" ng-repeat="idee in reperto.display.pager.pagerItems track by $index" ng-click="reperto.setPagerIndex($index)">{{$index + 1}}</a></li>
					  </ul>
					</nav>
				</div>
			</div>
			
			
	 
	 
			<div ng-hide="reperto.navigationmode == 'print'" class="col-lg-3" style="float: right; background-color: rgba(25,25,50,0.3); border-radius: 5px; padding: 15px; margin-right: -15px; margin-bottom: 15px; color: white">
				<h4>BOITE A OUTIL</h4>
				<div>
					<p>
						<span ng-click="reperto.changeNavigationMode('map')" class="btn btn-default">
							<span class="glyphicon glyphicon-map-marker"></span>
							&nbsp;Navigation par carte
							<span ng-show="reperto.navigationmode == 'map'" class="glyphicon glyphicon-check"></span>
						</span>
					</p>
					<p>
						<span ng-click="reperto.changeNavigationMode('tree')" class="btn btn-default">
							<span class="glyphicon glyphicon-th-list"></span>&nbsp;Navigation par arborescence
							<span ng-show="reperto.navigationmode == 'tree'" class="glyphicon glyphicon-check"></span>
						</span>
						</p>
					<p ng-hide="true"><span class="btn btn-default" ng-click="reperto.changeBackground()"><span class="glyphicon glyphicon-picture"></span> Changer le fond</span></p>
				
					<span ng-show="reperto.printableGuide.activeInitiatives.length == 0">
						<p>Vous n'avez pas encore ajouté d'initiatives à votre panier. Cliquez sur <span class="glyphicon glyphicon-star-empty"></span> d'une initiative pour le rajouter.</p>
					</span>
					
					<span ng-show="reperto.printableGuide.activeInitiatives.length > 0">
						<p>{{reperto.printableGuide.activeInitiatives.length}} sauvées.</p>
						<p><span ng-click="reperto.refreshPrintableCatalogue()" class="btn btn-default"><span class="glyphicon glyphicon-download-alt"></span>&nbsp; Exporter la sélection en pdf</span></p>
					</span>
				</div>
			</div>
			
			
			<div ng-hide="reperto.navigationmode == 'print'" 
						class="col-lg-3 {{reperto.display.section.id}} infozone" 
						style="float: right;  background-color: rgba(25,25,50,0.3); border-radius: 5px; padding: 15px; margin-right: -15px; color: white"
			>
				<h4>INFO</h4>
				<p ng-show="reperto.display.section">
					<h3 ng-show="reperto.display.section" ng-bind-html="reperto.display.section.titre"></h3>
					
					<span ng-hide="reperto.display.section.displaylong" ng-bind-html="reperto.display.section.description"></span>
					<span ng-show="reperto.display.section.displaylong" ng-bind-html="reperto.display.section.descriptionlongue"></span>
					
					
					<a href="" ng-show="reperto.display.section && ! reperto.display.section.displaylong" ng-click="reperto.display.section.displaylong = true">voir plus</a>
					<a href="" ng-show="reperto.display.section && reperto.display.section.displaylong" ng-click="reperto.display.section.displaylong = false">voir moins</a>
				</p>
				
				<p ng-show="reperto.display.chapitre">
					<h3 ng-show="reperto.display.chapitre" ng-bind-html="reperto.display.chapitre.titre"></h3>
					
					<span ng-hide="reperto.display.chapitre.displaylong" ng-bind-html="reperto.display.chapitre.description"></span>
					<span ng-show="reperto.display.chapitre.displaylong" ng-bind-html="reperto.display.chapitre.descriptionlongue"></span>
					
					<a href="" ng-show="reperto.display.chapitre && ! reperto.display.chapitre.displaylong" ng-click="reperto.display.chapitre.displaylong = true">voir plus</a>
					<a href="" ng-show="reperto.display.chapitre && reperto.display.chapitre.displaylong" ng-click="reperto.display.chapitre.displaylong = false">voir moins</a>
				</p>
				
				<p ng-show="reperto.display.idee" ng-bind-html="reperto.display.idee.description"></p>
				<p ng-show="reperto.display.intro" ng-bind-html="reperto.thesaurus.description"></p>
			</div>
			
		</section>
	
	</div>
</div>


